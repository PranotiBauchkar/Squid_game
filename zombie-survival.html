<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zombie Survival</title>
<style>
body{
    margin:0;
    background:#0b0b15;
    font-family:sans-serif;
    color:white;
    display:flex;
    flex-direction:column;
    align-items:center;
}
#score,#timer{
    font-size:2em;
    margin:10px;
}
canvas{
    background:#141427;
    border:2px solid cyan;
}
</style>
</head>
<body>

<div id="score">Score: 0</div>
<div id="timer">00:01:00</div>
<canvas id="game" width="600" height="400"></canvas>

<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
let player={x:280,y:350,w:30,h:30,c:'cyan'};
let bullets=[], zombies=[], score=0;
let totalTime = 60; // in seconds
let gameOver=false;

// --- Key controls ---
document.addEventListener('keydown',e=>{
    if(e.key==='ArrowLeft' && player.x>0) player.x-=15;
    if(e.key==='ArrowRight' && player.x<570) player.x+=15;
    if(e.key===' ' && !gameOver) bullets.push({x:player.x+10,y:player.y,w:10,h:20,dy:-5});
});

// --- Spawn zombies ---
function spawnZombie(){ 
    if(!gameOver) zombies.push({x:Math.random()*570,y:0,w:30,h:30,dy:2}); 
}

// --- Update game objects ---
function update(){
    bullets.forEach((b,i)=>{
        b.y+=b.dy;
        zombies.forEach((z,j)=>{
            if(b.x<b.x+z.w && b.x+b.w>z.x && b.y<b.y+z.h && b.y+b.h>z.y){
                bullets.splice(i,1);
                zombies.splice(j,1);
                score++;
                document.getElementById('score').innerText='Score: '+score;
            }
        });
    });
    zombies.forEach(z=>{
        z.y+=z.dy;
        if(z.y>400) z.y=0;
    });
}

// --- Draw game objects ---
function draw(){
    ctx.clearRect(0,0,600,400);
    ctx.fillStyle=player.c; ctx.fillRect(player.x,player.y,player.w,player.h);
    bullets.forEach(b=>{ ctx.fillStyle='yellow'; ctx.fillRect(b.x,b.y,b.w,b.h); });
    zombies.forEach(z=>{ ctx.fillStyle='green'; ctx.fillRect(z.x,z.y,z.w,z.h); });
}

// --- Game loop ---
function loop(){
    if(!gameOver){
        update();
        draw();
        requestAnimationFrame(loop);
    }
}
loop();

// --- Spawn zombies every 1.5s ---
setInterval(spawnZombie,1500);

// --- Timer in hh:mm:ss format ---
function formatTime(seconds){
    const h = Math.floor(seconds/3600).toString().padStart(2,'0');
    const m = Math.floor((seconds%3600)/60).toString().padStart(2,'0');
    const s = (seconds%60).toString().padStart(2,'0');
    return `${h}:${m}:${s}`;
}

const timerInterval = setInterval(()=>{
    totalTime--;
    document.getElementById('timer').innerText = formatTime(totalTime);
    if(totalTime <= 0){
        gameOver=true;
        clearInterval(timerInterval);
        alert("Time Up! Score: "+score);

        // --- Save to leaderboard ---
        const playerName = prompt("Enter your name for the leaderboard:", "Player") || "Player";
        let leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
        leaderboard.push({player:playerName, game:'Zombie Survival', score:score});
        localStorage.setItem('leaderboard', JSON.stringify(leaderboard));

        // --- Redirect to leaderboard ---
        window.location.href = 'leaderboard.html';
    }
},1000);
</script>

</body>
</html>